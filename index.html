<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ignatius Location Tracker</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 20px;
    background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
    min-height: 100vh;
    color: white;
  }
  .container { max-width: 1000px; margin: 0 auto; text-align: center; }
  h1 { 
    font-size: 2.8em; margin-bottom: 10px; 
    background: linear-gradient(45deg, #fff, #a8e6cf);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  }
  .controls { 
    margin: 30px 0; display: flex; justify-content: center; gap: 15px; 
    flex-wrap: wrap; position: sticky; top: 20px; background: rgba(0,0,0,0.3);
    padding: 15px; border-radius: 20px; backdrop-filter: blur(20px);
  }
  button { 
    background: rgba(255,255,255,0.2); color: white; border: 2px solid rgba(255,255,255,0.4);
    padding: 15px 25px; font-size: 16px; border-radius: 50px; cursor: pointer;
    transition: all 0.3s ease; backdrop-filter: blur(10px);
  }
  button:hover:not(:disabled) { 
    background: rgba(255,255,255,0.3); transform: translateY(-3px) scale(1.05);
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
  }
  button:disabled { opacity: 0.5; cursor: not-allowed; }
  #status { 
    margin: 20px 0; font-size: 1.4em; font-weight: bold; min-height: 50px;
    padding: 20px; border-radius: 15px; backdrop-filter: blur(10px);
  }
  #accuracy-panel {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px; margin: 20px 0; background: rgba(0,0,0,0.4);
    padding: 20px; border-radius: 15px;
  }
  .accuracy-metric {
    background: rgba(255,255,255,0.1); padding: 15px;
    border-radius: 10px; text-align: center;
  }
  .accuracy-meter {
    width: 100%; height: 20px; background: rgba(0,0,0,0.5);
    border-radius: 10px; overflow: hidden; margin-top: 10px;
  }
  .accuracy-fill {
    height
  button {
    background: rgba(255,255,255,0.2);
    color: white;
    border: 2px solid rgba(255,255,255,0.3);
    padding: 15px 25px;
    font-size: 16px;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    position: relative;
    overflow: hidden;
  }
  button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
    transition: left 0.5s;
  }
  button:hover::before {
    left: 100%;
  }
  button:hover {
    background: rgba(255,255,255,0.3);
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
  }
  button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
  #status {
    margin: 20px 0;
    font-size: 1.3em;
    font-weight: bold;
    min-height: 40px;
    padding: 15px;
    border-radius: 10px;
    backdrop-filter: blur(10px);
  }
  #coords {
    background: rgba(0,0,0,0.3);
    padding: 20px;
    border-radius: 15px;
    margin: 20px 0;
    font-family: 'Courier New', monospace;
    border: 1px solid rgba(255,255,255,0.2);
  }
  #map {
    height: 550px;
    margin-top: 20px;
    border-radius: 20px;
    border: 4px solid rgba(255,255,255,0.2);
    box-shadow: 0 15px 40px rgba(0,0,0,0.4);
    position: relative;
    overflow: hidden;
  }
  .map-theme {
    transition: all 0.5s ease;
  }
  #themeToggle {
    position: absolute;
    top: 15px;
    right: 15px;
    z-index: 1000;
  }
</style>
</head>
<body>
<div class="container">
  <h1>üåç ignatius Location Tracker</h1>
  <div class="controls">
    <button id="detectBtn">üîç Detect Location</button>
    <button id="trackBtn">‚ñ∂Ô∏è Start Tracking</button>
    <button id="stopBtn" disabled>‚èπÔ∏è Stop Tracking</button>
    <button id="themeToggle">üåô Dark Theme</button>
  </div>
  <div id="status">Ready to track your location!</div>
  <div id="coords"></div>
  <div id="map"></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  const status = document.getElementById('status');
  const coords = document.getElementById('coords');
  const detectBtn = document.getElementById('detectBtn');
  const trackBtn = document.getElementById('trackBtn');
  const stopBtn = document.getElementById('stopBtn');
  const themeToggle = document.getElementById('themeToggle');
  
  let map, marker, watchId, isDarkTheme = false;
  let isTracking = false;

  // Custom marker icon with JS styling
  const createCustomMarker = (lat, lng) => {
    const pulseIcon = L.divIcon({
      className: 'custom-marker',
      html: `
        <div style="
          width: 40px; height: 40px; 
          background: ${isDarkTheme ? '#ff6b6b' : '#4ecdc4'};
          border-radius: 50%; 
          border: 4px solid ${isDarkTheme ? '#ff4757' : '#45b7d1'};
          box-shadow: 0 0 20px ${isDarkTheme ? '#ff6b6b' : '#4ecdc4'};
          animation: pulse 2s infinite;
          position: relative;
        ">
          <div style="
            width: 12px; height: 12px; 
            background: white; 
            border-radius: 50%; 
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 10px rgba(255,255,255,0.8);
          "></div>
        </div>
      `,
      iconSize: [40, 40],
      iconAnchor: [20, 20]
    });

    return L.marker([lat, lng], { icon: pulseIcon });
  };

  // Map style configurations
  const mapStyles = {
    light: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
    dark: 'https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png',
    satellite: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}'
  };

  function initMap(lat, lng) {
    map = L.map('map', {
      zoomControl: true,
      attributionControl: true,
      zoomAnimation: true,
      fadeAnimation: true,
      markerZoomAnimation: true
    }).setView([lat, lng], 16);

    // Load initial map style
    loadMapStyle(mapStyles.light);
    
    // Custom map controls styling
    map.zoomControl.setPosition('topright');
    
    // Add custom marker
    marker = createCustomMarker(lat, lng);
    marker.addTo(map).bindPopup(`
      <div style="text-align: center; font-weight: bold;">
        <b>üìç You Are Here</b><br>
        <small>Live GPS Position</small>
      </div>
    `).openPopup();
  }

  function loadMapStyle(styleUrl) {
    if (map) {
      map.eachLayer(layer => {
        if (layer instanceof L.TileLayer) {
          map.removeLayer(layer);
        }
      });
      
      L.tileLayer(styleUrl, {
        maxZoom: 19,
        attribution: isDarkTheme 
          ? '¬© CartoDB | ¬© OpenStreetMap contributors' 
          : '¬© OpenStreetMap contributors'
      }).addTo(map);
    }
  }

  function updateLocation(lat, lng, accuracy) {
    // Animate marker update
    marker.setLatLng([lat, lng], { animate: true });
    map.flyTo([lat, lng], 16, { duration: 1.5 });
    
    // Update coords with animation
    coords.style.transform = 'scale(1.05)';
    coords.innerHTML = `
      <strong>üìç Live GPS Position:</strong><br>
      <span style="font-size: 1.2em;">Lat: ${lat.toFixed(6)}¬∞</span><br>
      <span style="font-size: 1.2em;">Lng: ${lng.toFixed(6)}¬∞</span><br>
      <span style="color: ${accuracy < 20 ? '#51cf66' : '#ff6b6b'}">
        üìè Accuracy: ${accuracy.toFixed(0)}m ${accuracy < 20 ? '‚úÖ Excellent' : '‚ö†Ô∏è Fair'}
      </span>
    `;
    setTimeout(() => coords.style.transform = 'scale(1)', 200);
  }

  function showStatus(message, isError = false) {
    status.textContent = message;
    status.style.background = isError 
      ? 'rgba(255, 107, 107, 0.3)' 
      : 'rgba(81, 207, 102, 0.3)';
    status.style.border = isError 
      ? '2px solid #ff6b6b' 
      : '2px solid #51cf66';
  }

  function getLocation(oneTime = true) {
    if (!navigator.geolocation) {
      showStatus('‚ùå Geolocation not supported', true);
      return;
    }

    showStatus('üîç Detecting GPS location...');

    if (oneTime) {
      navigator.geolocation.getCurrentPosition(
        (position) => {
          const { latitude, longitude, accuracy } = position.coords;
          showStatus('‚úÖ Location locked!');
          updateLocation(latitude, longitude, accuracy);
          if (!map) initMap(latitude, longitude);
        },
        (error) => {
          const messages = {
            1: 'üö´ Location access denied',
            2: 'üì° GPS signal unavailable', 
            3: '‚è∞ Location timeout'
          };
          showStatus(messages[error.code] || '‚ùå Location error', true);
        },
        { timeout: 10000, enableHighAccuracy: true, maximumAge: 30000 }
      );
    } else {
      watchId = navigator.geolocation.watchPosition(
        (position) => updateLocation(position.coords.latitude, position.coords.longitude, position.coords.accuracy),
        (error) => showStatus('Tracking lost signal', true),
        { timeout: 5000, enableHighAccuracy: true }
      );
    }
  }

  // Event listeners
  detectBtn.addEventListener('click', () => getLocation(true));
  
  trackBtn.addEventListener('click', () => {
    isTracking = true;
    trackBtn.disabled = true;
    stopBtn.disabled = false;
    showStatus('‚ñ∂Ô∏è Real-time tracking active');
    getLocation(false);
  });
  
  stopBtn.addEventListener('click', () => {
    if (watchId) navigator.geolocation.clearWatch(watchId);
    isTracking = false;
    trackBtn.disabled = false;
    stopBtn.disabled = true;
    showStatus('‚èπÔ∏è Tracking stopped');
  });

  themeToggle.addEventListener('click', () => {
    isDarkTheme = !isDarkTheme;
    themeToggle.textContent = isDarkTheme ? '‚òÄÔ∏è Light Theme' : 'üåô Dark Theme';
    
    // Recreate marker with new theme
    if (marker) {
      map.removeLayer(marker);
      const currentCenter = map.getCenter();
      marker = createCustomMarker(currentCenter.lat, currentCenter.lng);
      marker.addTo(map);
    }
    
    // Switch map style
    const style = isDarkTheme ? mapStyles.dark : mapStyles.light;
    loadMapStyle(style);
    showStatus(isDarkTheme ? 'üåô Dark theme activated' : '‚òÄÔ∏è Light theme activated');
  });

  // Add pulse animation CSS via JS
  const style = document.createElement('style');
  style.textContent = `
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(255,255,255,0.7); }
      70% { box-shadow: 0 0 0 20px rgba(255,255,255,0); }
      100% { box-shadow: 0 0 0 0 rgba(255,255,255,0); }
    }
  `;
  document.head.appendChild(style);
</script>
</body>
</html>
<button id="locateBtn">Detect My Location</button>
<div id="status"></div>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  const status = document.getElementById('status');
  const locateBtn = document.getElementById('locateBtn');
  let map, marker;

  function initMap(lat, lng) {
    // Initialize map centered on user's location
    map = L.map('map').setView([lat, lng], 13);

    // Use OpenStreetMap tiles
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '¬© OpenStreetMap contributors'
    }).addTo(map);

    // Add a marker for user's location
    marker = L.marker([lat, lng]).addTo(map).bindPopup('You are here').openPopup();
  }

  function updateMarker(lat, lng) {
    marker.setLatLng([lat, lng]);
    map.setView([lat, lng], map.getZoom());
  }

  function getLocation() {
    if (!navigator.geolocation) {
      status.textContent = 'Geolocation is not supported by your browser.';
      return;
    }
    status.textContent = 'Locating‚Ä¶';

    navigator.geolocation.getCurrentPosition(
      (position) => {
        const { latitude, longitude } = position.coords;
        status.textContent = `Latitude: ${latitude.toFixed(5)}, Longitude: ${longitude.toFixed(5)}`;
        if (!map) {
          initMap(latitude, longitude);
        } else {
          updateMarker(latitude, longitude);
        }
      },
      () => {
        status.textContent = 'Unable to retrieve your location.';
      }
    );
  }

  locateBtn.addEventListener('click', getLocation);
</script>
</body>
</html>
